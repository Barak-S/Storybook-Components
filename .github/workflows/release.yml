name: Create Release
on:
  workflow_dispatch:
    inputs:
      versionName:
        description: Name of the release  (ie 1.0)
        required: true
        default: "1.0"

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      - name: Install CLI
        run: |
          cd scripts
          make
          echo "$(yarn global bin)" >> $GITHUB_PATH
          cd ..
          git reset --hard
      - name: Create release branch
        run: git checkout -b release/${{ github.event.inputs.versionName }}
      - name: Initialize mandatory git config
        run: |
          git config user.name "GitHub Actions"
          git config user.email noreply@github.com
      - name: Push new branch
        run: git push origin release/${{ github.event.inputs.versionName }}
      - name: Create pull request into master
        uses: thomaseizinger/create-pull-request@1.0.0
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          head: release/${{ github.event.inputs.versionName }}
          base: master
          title: v${{ github.event.inputs.versionName }} into master
          reviewers: ${{ github.event.issue.user.login }}
          body: |
            Hi!
            This PR was created in response workflow running.
      - name: Create pull request into beta
        uses: thomaseizinger/create-pull-request@1.0.0
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          head: release/${{ github.event.inputs.versionName }}
          base: beta
          title: v${{ github.event.inputs.versionName }} into beta
          reviewers: ${{ github.event.issue.user.login }}
          body: |
            Hi!
            This PR was created in response workflow running.
      # - name: Create pull request into develop
      #   uses: thomaseizinger/create-pull-request@1.0.0
      #   with:
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      #     head: release/${{ github.event.inputs.versionName }}
      #     base: develop
      #     title: v${{ github.event.inputs.versionName }} into develop
      #     reviewers: ${{ github.event.issue.user.login }}
      #     body: |
      #       Hi!
      #       This PR was created in response workflow running.
